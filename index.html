<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Incorporating Trait Information in Population Growth Models: a Lotka-Volterra example</title>
    <meta charset="utf-8" />
    <meta name="author" content="Olusoji Oluwafemi Daniel, Thomas Neyens, Marc Aerts, Frederik De Laender" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">








class: inverse, center

&lt;div style="text-align: left"&gt;
&lt;img style="float: center; margin: 0px 15px 15px 0px;" src="Pics/DSI-logo.png" width="80" height="80"/&gt;
&lt;/div&gt;


## Incorporating Trait Information in Population Growth Models: a Lotka-Volterra example

#### HTML Slides: https://fomotis.github.io/researchday/

&lt;div style="text-align: right"&gt;
&lt;img style="float: center; margin: 0px 15px 15px 0px;" src="Pics/ilee.jpg" width="120" height="120"/&gt;
&lt;/div&gt;


---

class: center, middle

#  Introduction

---

# Traits and its Importance

* Traits are simply put characteristics (genetic and/or phenotypic) of a species.

* Traits can influence the survival of a species.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Pics/moths.jpg" alt="Peppered moths survival during the industrial evolution in Britain." width="40%" height="40%" /&gt;
&lt;p class="caption"&gt;Peppered moths survival during the industrial evolution in Britain.&lt;/p&gt;
&lt;/div&gt;

* Could fetch you an article in [BBC](https://www.bbc.com/news/science-environment-36424768) and [New York Times](https://www.nytimes.com/2016/06/02/science/moths-butterflies-dna-cortex-genes.html).

---

# Traits (Cont.)

* Traits are measured per individual for each species. Thus,

`$$M = \left(\begin{array}{ccc} b_{11} &amp; \cdots &amp; b_{1m}\\ \vdots &amp; \vdots &amp; \vdots \\ b_{n1} &amp; \cdots &amp; b_{nm}  \end{array}\right)$$`

* Longitudinal measurements are also possible. This is especially done if evolution is of interest.

---

# Characterising Population Growth (Lotka-Volterra Model)

`\begin{equation}
\frac{dN}{dt} = diag(N) (R - AN)
\end{equation}`

* **Two Species Case**

`\begin{equation}
\left(\begin{array}{c}\frac{d N_1}{d t} \\  \frac{d N_2}{d t} \end{array} \right) = \left(\begin{array}{c} N_1 \\ N_2
\end{array} \right) \left[ \left( \begin{array}{c} r_1 \\ r_2 \end{array} \right) - \left( \begin{array}{cc} \alpha_{11} &amp; \alpha_{12} \\ \alpha_{21} &amp; \alpha_{22} \end{array} \right)\left( \begin{array}{c} N_{1} \\ N_{2} \end{array} \right) \right] 
\end{equation}`

.pull-left[
* R is a vector of `\(r\)`'s growth rates.
* `\(A\)` is a matrix of `\(\alpha's\)`
  - `\(\alpha_{ij}, i = j\)` are intraspecific interaction/competition.
  - `\(\alpha_{ij}, i \neq j\)` are interspecific interaction/competition.
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-3-1.png" width="60%" height="60%" style="display: block; margin: auto;" /&gt;
]

---
class: center, middle

#  Motivating the problem


---

# Ecological Questions of Interest

* Broader Question: what role do traits play in biodiveristy dynamics?

* Specific Question: what is the role of traits in **growth**, **competition** and co-existence of species?


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Pics/EcologicalPerspective.PNG" alt="Effects of Interest." width="60%" height="60%" /&gt;
&lt;p class="caption"&gt;Effects of Interest.&lt;/p&gt;
&lt;/div&gt;

---

## The Modeling Challenge

* Connecting a vector/matrix of trait values to density points such that the ecological questions are answered.

&lt;img src="Pics/StatisticalPerspective.PNG" width="80%" height="80%" style="display: block; margin: auto;" /&gt;

---

## An Added Layer

* What about environmental factors?

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Pics/Environment.PNG" alt="Possible Effects" width="80%" height="80%" /&gt;
&lt;p class="caption"&gt;Possible Effects&lt;/p&gt;
&lt;/div&gt;

---

class: center, middle

#  Existing methods

---

## A Quick Literature Dive


* The focus is on character displacement approach to trait based ecology.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Pics/Literature.PNG" alt="Publication timeline for character displacement approach to trait based ecology" width="80%" height="80%" /&gt;
&lt;p class="caption"&gt;Publication timeline for character displacement approach to trait based ecology&lt;/p&gt;
&lt;/div&gt;


---

## Quantitative Genetic Lotka-Volterra (Barabas et al. 2015)

* Let `\(T(t)\)` be a trait vector measured at `\(t\)`, `\(T(t) \sim N(\mu(t), \sigma^2)\)`

`\begin{eqnarray}
\frac{dN_i(t)}{dt} &amp;=&amp; N_i(t) \int r_i(N, p, z, t) p_i(z, t)dz \\
r_i(N, p, z, t) &amp;=&amp; b(z) - \sum_{j = 1}^{S}N_j(t) \int a(z, z') p_j(z', t) dz'\\
\frac{dN_i(t)}{dt} &amp;=&amp; N_i(t) \left(b_i(t) - \sum_{j = 1}^{S} \alpha_{ij}(t) N_j(t) \right)\\
b_i(t) &amp;=&amp;  \int p_i(z, t)b(z) dz\\
\alpha_{ij}(t) &amp;=&amp; \int\int p_i(z, t) a(z, z') p_j(z', t) dz' dz
\end{eqnarray}`

* `\(a(z, z')\)` and `\(b(z)\)` are appropriately chosen functions to describe interaction and intrinsic growth rate.

---

## Interaction Kernel `\(a(z, z')\)` and Growth Rate `\(b(z)\)`

* If `\(a(z, z') = exp\left( - \frac{(z - z')^2}{\omega^2}\right)\)` then,

`\begin{eqnarray}
\alpha_{ij}(t) &amp;=&amp; \int\int p_i(z, t) a(z, z') p_j(z', t) dz' dz \\
&amp;=&amp; \frac{w}{\sqrt{2\sigma^2_i + 2\sigma^2_j + w^2}} exp\left(-\frac{(\mu_{i}(t) - \mu_{j}(t))^2}{2\sigma^2_i + 2\sigma^2_j + w^2} \right)
\end{eqnarray}`

* Note that, `\(\alpha_{ij} = \frac{w}{\sqrt{4\sigma^2_i + w^2}}\)`, when `\(i = j\)`

* If `\(b(z) = r_i, -\infty &lt; z &lt; \infty\)` then,

`$$b_i(t) = \int p_i(z, t)b(z) dz = r_i$$` 
---

## Quantitative Genetic Lotka-Volterra (Two Species)

`\begin{equation}
\left(\begin{array}{c}\frac{d N_1}{d t} \\  \frac{d N_2}{d t} \end{array} \right) = \left(\begin{array}{c} N_1 \\ N_2
\end{array} \right) \left[ \left( \begin{array}{c} r_1 \\ r_2 \end{array} \right) - \left( \begin{array}{cc}  \alpha_{11}&amp;  \alpha_{12} \\ \alpha_{21}&amp;  \alpha_{22} \end{array} \right)\left( \begin{array}{c} N_{1} \\ N_{2} \end{array} \right) \right] 
\end{equation}`

* `\(\alpha_{11} = \frac{w}{\sqrt{4\sigma^2_1 + w^2}}\)`

* `\(\alpha_{12} = \alpha_{21} = \frac{w}{\sqrt{2\sigma^2_1 + 2\sigma^2_2 + w^2}} exp\left(-\frac{(\mu_{1}(t) - \mu_{2}(t))^2}{2\sigma^2_1 + 2\sigma^2_2 + w^2} \right)\)`

* `\(\alpha_{22} = \frac{w}{\sqrt{4\sigma^2_2 + w^2}}\)`

---

class: center, middle

# Data and experiments

---

## Experiments

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="pics/monoculture_experiment.PNG" alt="Monoculture Experiment" width="45%" height="45%" /&gt;
&lt;p class="caption"&gt;Monoculture Experiment&lt;/p&gt;
&lt;/div&gt;



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Pics/biculture_experiment.PNG" alt="Biculture Experiment" width="45%" height="45%" /&gt;
&lt;p class="caption"&gt;Biculture Experiment&lt;/p&gt;
&lt;/div&gt;

* Traits Investigated: *RED.B (Chlorophyll a)*, *YEL.B (Phycoerytherin)*, *FSC (Size)*

---

## Data

.pull-left[
&lt;img src="index_files/figure-html/unnamed-chunk-10-1.png" width="70%" height="60%" style="display: block; margin: auto;" /&gt;&lt;img src="index_files/figure-html/unnamed-chunk-10-2.png" width="70%" height="60%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-11-1.png" width="70%" height="60%" style="display: block; margin: auto;" /&gt;&lt;img src="index_files/figure-html/unnamed-chunk-11-2.png" width="70%" height="60%" style="display: block; margin: auto;" /&gt;
]

---

## Fitting The Model

`\begin{equation}
\left(\begin{array}{c}N_1 \\  N_2 \end{array} \right) \sim MVN\left( \int\left(\begin{array}{c}\frac{d N_1}{d t} \\  \frac{d N_2}{d t} \end{array} \right), \Sigma \right)
\end{equation}`

* `\(\Sigma = \left( \begin{array}{cc} \sigma^2_1 &amp; \rho\sigma_1\sigma_2 \\ \rho\sigma_1\sigma_2 &amp; \sigma^2_2 \end{array} \right)\)`

* `\(\hat{\alpha}_{12} = \frac{w}{\sqrt{2s^2_1 + 2s^2_2 + w^2}} exp\{-\frac{(\bar{z}_{i}(t) - \bar{z}_{j}(t))^2}{2s^2_1 + 2s^2_2 + w^2} \}\)`, thus `\(\hat{\alpha}_{ii} = \frac{w}{\sqrt{4s^2_i + w^2}}, i=1, 2\)`

* `\(\bar{z}_{i}(t)\)` is obtained by pooling `\(\frac{\sum^{n(t)}_{k=1} z_{ik}}{n(t)}\)` across replicates

* `\(s^2_1, s^2_j\)` are obtained by pooling `\(\frac{\sum^{n(t)}_{k=1}(z_{ik} - \bar{z}_{i}(t))^2}{n(t) - 1}\)` across replicates and `\(t\)`

* For monoculture; `\(\hat{\alpha}_{12} = 0\)`, `\(\Sigma = \left( \begin{array}{cc} \sigma^2_1 &amp; 0 \\ 0 &amp; \sigma^2_2 \end{array} \right)\)`

---

## Fitting The Model (cont.)

* **Normal-LVE** `\(\Rightarrow \alpha_{ij}\)` are parameters.
* **Symmetric-LVE** `\(\Rightarrow \alpha_{ij} = \alpha_{ji}, i \neq j\)` 
* **Barabas** `\(\Rightarrow \alpha_{ij} = \frac{w}{\sqrt{2s^2_1 + 2s^2_2 + w^2}} exp\{-\frac{(\bar{z}_{1}(t) - \bar{z}_{2}(t))^2}{2s^2_1 + 2s^2_2 + w^2} \}\)` 

* **Barabas (Permute)** `\(\Rightarrow \alpha_{ij}\)` as in Barabas, but `\(\bar{z}_{i}(t) = \bar{z}_{i}(t') \ \ \ \forall \ \ \ t \neq t'\)`. Only for RED.B.HLin.

---
class: center, middle

## Results

---

## Results `\((N_0's)\)`

&lt;img src="Pics/All_traits_N02.png" width="65%" height="60%" style="display: block; margin: auto;" /&gt;
---

## Results `\((r's)\)`

&lt;img src="Pics/All_traits_r2.png" width="65%" height="60%" style="display: block; margin: auto;" /&gt;

---
## Results `\((w)\)`

&lt;img src="Pics/All_traits_w.png" width="65%" height="60%" style="display: block; margin: auto;" /&gt;
---

## Results `\((\alpha_{ij}, i = j)\)`

&lt;img src="Pics/All_traits_alpha1122.png" width="65%" height="60%" style="display: block; margin: auto;" /&gt;

---

## Results `\((\alpha_{ij}, i \neq j)\)`


&lt;img src="Pics/All_traits_alpha12_18.png" width="90%" height="80%" style="display: block; margin: auto;" /&gt;


---

## Results `\((\alpha_{ij}, i \neq j)\)`

&lt;img src="Pics/All_traits_alpha12_20.png" width="90%" height="80%" style="display: block; margin: auto;" /&gt;


---
## Results `\((\alpha_{ij}, i \neq j)\)`

&lt;img src="Pics/All_traits_alpha12_22.png" width="90%" height="80%" style="display: block; margin: auto;" /&gt;

---
## Results `\((\alpha_{ij}, i \neq j)\)`

&lt;img src="Pics/All_traits_alpha1221_Mean.png" width="90%" height="80%" style="display: block; margin: auto;" /&gt;

---
## Model Prediction (B4s)

&lt;img src="Pics/All_b4_preds.png" width="70%" height="70%" style="display: block; margin: auto;" /&gt;
---
## Model Prediction (B5s)

&lt;img src="Pics/All_b5_preds.png" width="90%" height="70%" style="display: block; margin: auto;" /&gt;

---
## Model Comparison (Model Posterior Probabilities)

&lt;table class="table table-striped table-hover table-condensed" style="font-size: 11px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Temperature &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Weights &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Normal.LVE &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Symmetric.LVE &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Brabas.RED.B.HLin. &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Barabas.YEL.B.HLin. &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Barabas.FSC.HLin. &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Barabas.Permute. &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; pbma &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.152 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.165 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.666 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.017 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; BB &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.175 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.175 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.575 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.018 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.011 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.046 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; stacking &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.864 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.135 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; pbma &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.009 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.045 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.486 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.170 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.267 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.023 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; BB &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.011 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.048 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.374 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.202 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.321 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.044 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; stacking &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.531 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.054 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.415 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; pbma &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.058 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.079 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.618 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.112 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.003 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; BB &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.050 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.066 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.409 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.154 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.317 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.005 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; stacking &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.418 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.169 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.413 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;
&lt;tr&gt;&lt;td style="padding: 0; border: 0;" colspan="100%"&gt;&lt;span style="font-style: italic;"&gt;Note: &lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="padding: 0; border: 0;" colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; Model Posterior probabilities computed using different weights.&lt;br&gt;BB=Bayesian Bootstrap&lt;br&gt;pbma=Pseudo Bayesian Model Averaging&lt;/td&gt;&lt;/tr&gt;
&lt;/tfoot&gt;
&lt;/table&gt;


---

## On-going work

### Some Things to Consider

* `\(b(z) = r_i, -\infty &lt; z &lt; \infty\)` ❓

* What about the uncertainty about `\(\frac{\sum^{n(t)}_{k=1} z_{ik}}{n(t)}\)` ❓

### Other Growth Functions

* Uniform growth: `\(\begin{cases}b(z) = \gamma, \kappa &lt; z &lt; \kappa+2\gamma  \\ 0, \text{otherwise}\end{cases}\)`

* Quadratic grwoth: `\(\begin{cases} \gamma^2 - (z - \kappa - \gamma)^2, \kappa &lt; z &lt; \kappa+2\gamma \\ 0, \text{otherwise}\end{cases}\)`

* Triangular growth: `\(\begin{cases} \gamma - |z - \kappa - \gamma|, \kappa &lt; z &lt; \kappa+2\gamma \\ 0, \text{otherwise}\end{cases}\)`


---
class: center, middle

##  Questions &amp; Suggestions 😀
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="cols_macro.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
